<div class="flex-auto bg-card rounded-lg">

    <!-- Upload file -->
    <div class="ml-10 mr-6 mt-6 flex items-center justify-between sm:mr-10">
        <div class="flex flex-col sm:flex-row md:flex-col flex-auto justify-between py-8">
            <div class="flex items-center ">

                <input #fileInput class="absolute h-0 w-0 opacity-0 invisible pointer-events-none" type="file" [multiple]="true"
                    (change)="onFileSelected($event)">
                <a mat-stroked-button (click)="triggerFileInput()">
                    <span class="inline-flex items-center cursor-pointer">
                        <mat-icon class="mr-2 icon-size-5" [svgIcon]="'heroicons_outline:folder-open'"></mat-icon>
                        <span>選擇檔案</span>
                    </span>
                </a>

                <!-- <div class="flex-auto"></div>
                <input id="file-input" class="absolute h-0 w-0 opacity-0 invisible pointer-events-none" type="file" [multiple]="true"
                    (change)="onFileSelected($event)">
                <label class="flex items-center justify-center w-10 h-10 rounded-full cursor-pointer ml-2 hover:bg-hover" for="file-input">
                    <mat-icon [svgIcon]="'heroicons_outline:folder-open'"></mat-icon>
                </label> -->

            </div>
        </div>
    </div>

    <div class="ml-10 mr-6 mt-2 flex flex-auto flex-col result-table initial-height">
        <p-table [value]="files" [tableStyle]="{ 'min-width': '50rem' }" [scrollable]="true" scrollHeight="100%">
            <ng-template pTemplate="header">
                <tr>
                    <!-- <th class="min-w-20">NO</th> -->
                    <th class="min-w-60">檔案名稱</th>
                    <th class="min-w-60">檔案大小</th>
                    <th class="min-w-30 text-center">處理狀態</th>
                    <th class="min-w-60 text-center">上傳</th>
                </tr>
            </ng-template>
            <ng-template pTemplate="body" let-file let-no="rowIndex">
                <tr>
                    <!-- <td>{{no+1}}</td> -->
                    <td>{{file.name}}</td>
                    <td>{{file.size}}</td>
                    <td class="text-center">
                        @if(file.status==='process'){<mat-progress-bar class="" [mode]="'determinate'" [value]="file.progress"></mat-progress-bar>}
                        @else if(file.status==='complete'){<i class="pi text-green-500 pi-check-circle"></i>}
                        @else{<span class="text-green-900 dark:text-green-300">{{file.status||'準備上傳'}}</span>}
                    </td>
                    <td class="text-center">
                        <!-- <button mat-button class="text-primary" (click)="onStartUpload(file)" [disabled]="file.status==='Completed'">Upload</button> -->
                        <!-- <button mat-button class="underline" color="primary" (click)="onUpload(file)">Upload</button> -->
                        <button class="fuse-alert-dismiss-button"mat-icon-button (click)="onUpload(file)">
                            <mat-icon [svgIcon]="'heroicons_outline:cloud-arrow-up'"></mat-icon>
                        </button>

                        <!-- @if(file.status==='complete'){
                        <button mat-button color="primary"><mat-icon [svgIcon]="'heroicons_outline:check-circle'"></mat-icon></button>
                        }
                        @else{
                        <button mat-button class="underline" color="primary" [disabled]="file.status" (click)="onUpload(file)">upload</button>
                        } -->
                    </td>
                </tr>
            </ng-template>

        </p-table>
    </div>
</div>


<!-- <div class="flex-auto">    
    <div class="flex flex-col sm:flex-row md:flex-col flex-auto justify-between py-8">
        <div class="flex items-center">
            <div class="flex-auto"></div>
            <input id="file-input" class="absolute h-0 w-0 opacity-0 invisible pointer-events-none" type="file" [multiple]="true"
                (change)="onFileSelected($event)">
            <label class="flex items-center justify-center w-10 h-10 rounded-full cursor-pointer ml-2 hover:bg-hover" for="file-input">
                <mat-icon [svgIcon]="'heroicons_outline:folder-open'"></mat-icon>
            </label>           
        </div>
    </div>

    <div class="relative">
        <table class="default-item-table">
            <thead>
                <tr>
                    <th class="w-20">NO</th>
                    <th>File Name</th>
                    <th class="w-36">Size</th>
                    <th class="w-48">Status</th>
                    <th class="w-36">Action</th>
                </tr>
            </thead>

            <tbody *ngIf="files">
                @for (file of files; track trackByFn;let no=$index) {
                <tr>
                    <td class="text-center">{{no+1}}</td>
                    <td class="px-3">{{file.name}}</td>
                    <td class="text-center">{{file.size}}</td>
                    <td class="text-center">
                        @if(file.status==='process'){<mat-progress-bar class="" [mode]="'determinate'" [value]="file.progress"></mat-progress-bar>}
                        @else{<span class="text-green-900">{{file.status||'ready'}}</span>}
                    </td>
                    <td class="text-center">
                        @if(file.status==='complete'){
                        <button mat-button color="primary"><mat-icon [svgIcon]="'heroicons_outline:check-circle'"></mat-icon></button>
                        }
                        @else{
                        <button mat-button class="underline" color="primary" [disabled]="file.status" (click)="onUpload(file)">upload</button>
                        }
                    </td>
                </tr>
                }
            </tbody>
        </table>
    </div>
</div> -->